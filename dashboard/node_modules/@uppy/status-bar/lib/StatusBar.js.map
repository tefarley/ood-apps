{"version":3,"sources":["StatusBar.jsx"],"names":["classNames","statusBarStates","calculateProcessingProgress","STATE_ERROR","STATE_WAITING","STATE_PREPROCESSING","STATE_UPLOADING","STATE_POSTPROCESSING","STATE_COMPLETE","StatusBar","props","newFiles","allowNewUpload","isUploadInProgress","isAllPaused","resumableUploads","error","hideUploadButton","hidePauseResumeButton","hideCancelButton","hideRetryButton","recoveredState","uploadState","totalProgress","files","supportsUploadProgress","hideAfterFinish","isSomeGhost","doneButtonHandler","isUploadStarted","i18n","startUpload","uppy","isAllComplete","showProgressDetails","numUploads","complete","totalSize","totalETA","totalUploadedSize","getProgressValue","progress","mode","value","getIsIndeterminate","getIsHidden","progressValue","isHidden","width","showUploadBtn","showCancelBtn","showPauseResumeBtn","showRetryBtn","showDoneBtn","progressClassNames","statusBarClassNames"],"mappings":"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","sourcesContent":["// TODO: rename this file to StatusBarUI>jsx on the next major.\nimport { h } from 'preact'\nimport classNames from 'classnames'\nimport statusBarStates from './StatusBarStates.js'\nimport calculateProcessingProgress from './calculateProcessingProgress.js'\n\nimport {\n  UploadBtn,\n  RetryBtn,\n  CancelBtn,\n  PauseResumeButton,\n  DoneBtn,\n  ProgressBarProcessing,\n  ProgressBarError,\n  ProgressBarUploading,\n  ProgressBarComplete,\n} from './Components.jsx'\n\nconst {\n  STATE_ERROR,\n  STATE_WAITING,\n  STATE_PREPROCESSING,\n  STATE_UPLOADING,\n  STATE_POSTPROCESSING,\n  STATE_COMPLETE,\n} = statusBarStates\n\n// TODO: rename the function to StatusBarUI on the next major.\nexport default function StatusBar (props) {\n  const {\n    newFiles,\n    allowNewUpload,\n    isUploadInProgress,\n    isAllPaused,\n    resumableUploads,\n    error,\n    hideUploadButton,\n    hidePauseResumeButton,\n    hideCancelButton,\n    hideRetryButton,\n    recoveredState,\n    uploadState,\n    totalProgress,\n    files,\n    supportsUploadProgress,\n    hideAfterFinish,\n    isSomeGhost,\n    doneButtonHandler,\n    isUploadStarted,\n    i18n,\n    startUpload,\n    uppy,\n    isAllComplete,\n    showProgressDetails,\n    numUploads,\n    complete,\n    totalSize,\n    totalETA,\n    totalUploadedSize,\n  } = props\n\n  function getProgressValue () {\n    switch (uploadState) {\n      case STATE_POSTPROCESSING:\n      case STATE_PREPROCESSING: {\n        const progress = calculateProcessingProgress(files)\n\n        if (progress.mode === 'determinate') {\n          return progress.value * 100\n        }\n        return totalProgress\n      }\n      case STATE_ERROR: {\n        return null\n      }\n      case STATE_UPLOADING: {\n        if (!supportsUploadProgress) {\n          return null\n        }\n        return totalProgress\n      }\n      default:\n        return totalProgress\n    }\n  }\n\n  function getIsIndeterminate () {\n    switch (uploadState) {\n      case STATE_POSTPROCESSING:\n      case STATE_PREPROCESSING: {\n        const { mode } = calculateProcessingProgress(files)\n        return mode === 'indeterminate'\n      }\n      case STATE_UPLOADING: {\n        if (!supportsUploadProgress) {\n          return true\n        }\n        return false\n      }\n      default:\n        return false\n    }\n  }\n\n  function getIsHidden () {\n    if (recoveredState) {\n      return false\n    }\n\n    switch (uploadState) {\n      case STATE_WAITING:\n        return hideUploadButton || newFiles === 0\n      case STATE_COMPLETE:\n        return hideAfterFinish\n      default:\n        return false\n    }\n  }\n\n  const progressValue = getProgressValue()\n\n  const isHidden = getIsHidden()\n\n  const width = progressValue ?? 100\n\n  const showUploadBtn = !error\n    && newFiles\n    && !isUploadInProgress\n    && !isAllPaused\n    && allowNewUpload\n    && !hideUploadButton\n\n  const showCancelBtn = !hideCancelButton\n    && uploadState !== STATE_WAITING\n    && uploadState !== STATE_COMPLETE\n\n  const showPauseResumeBtn = resumableUploads\n    && !hidePauseResumeButton\n    && uploadState === STATE_UPLOADING\n\n  const showRetryBtn = error && !isAllComplete && !hideRetryButton\n\n  const showDoneBtn = doneButtonHandler && uploadState === STATE_COMPLETE\n\n  const progressClassNames = classNames('uppy-StatusBar-progress', {\n    'is-indeterminate': getIsIndeterminate(),\n  })\n\n  const statusBarClassNames = classNames(\n    'uppy-StatusBar',\n    `is-${uploadState}`,\n    { 'has-ghosts': isSomeGhost },\n  )\n\n  return (\n    <div className={statusBarClassNames} aria-hidden={isHidden}>\n      <div\n        className={progressClassNames}\n        style={{ width: `${width}%` }}\n        role=\"progressbar\"\n        aria-label={`${width}%`}\n        aria-valuetext={`${width}%`}\n        aria-valuemin=\"0\"\n        aria-valuemax=\"100\"\n        aria-valuenow={progressValue}\n      />\n\n      {(() => {\n        switch (uploadState) {\n          case STATE_PREPROCESSING:\n          case STATE_POSTPROCESSING:\n            return <ProgressBarProcessing progress={calculateProcessingProgress(files)} />\n          case STATE_COMPLETE:\n            return <ProgressBarComplete i18n={i18n} />\n          case STATE_ERROR:\n            return (\n              <ProgressBarError\n                error={error}\n                i18n={i18n}\n                numUploads={numUploads}\n                complete={complete}\n              />\n            )\n          case STATE_UPLOADING:\n            return (\n              <ProgressBarUploading\n                i18n={i18n}\n                supportsUploadProgress={supportsUploadProgress}\n                totalProgress={totalProgress}\n                showProgressDetails={showProgressDetails}\n                isUploadStarted={isUploadStarted}\n                isAllComplete={isAllComplete}\n                isAllPaused={isAllPaused}\n                newFiles={newFiles}\n                numUploads={numUploads}\n                complete={complete}\n                totalUploadedSize={totalUploadedSize}\n                totalSize={totalSize}\n                totalETA={totalETA}\n                startUpload={startUpload}\n              />\n            )\n          default:\n            return null\n        }\n      })()}\n\n      <div className=\"uppy-StatusBar-actions\">\n        {recoveredState || showUploadBtn ? (\n          <UploadBtn\n            newFiles={newFiles}\n            isUploadStarted={isUploadStarted}\n            recoveredState={recoveredState}\n            i18n={i18n}\n            isSomeGhost={isSomeGhost}\n            startUpload={startUpload}\n            uploadState={uploadState}\n          />\n        ) : null}\n\n        {showRetryBtn ? <RetryBtn i18n={i18n} uppy={uppy} /> : null}\n\n        {showPauseResumeBtn ? (\n          <PauseResumeButton\n            isAllPaused={isAllPaused}\n            i18n={i18n}\n            isAllComplete={isAllComplete}\n            resumableUploads={resumableUploads}\n            uppy={uppy}\n          />\n        ) : null}\n\n        {showCancelBtn ? <CancelBtn i18n={i18n} uppy={uppy} /> : null}\n\n        {showDoneBtn ? (\n          <DoneBtn i18n={i18n} doneButtonHandler={doneButtonHandler} />\n        ) : null}\n      </div>\n    </div>\n  )\n}\n"]}