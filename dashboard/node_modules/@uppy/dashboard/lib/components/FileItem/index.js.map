{"version":3,"sources":["index.jsx"],"names":["classNames","shallowEqual","FilePreviewAndLink","FileProgress","FileInfo","Buttons","FileItem","Component","componentDidMount","file","props","preview","handleRequestThumbnail","shouldComponentUpdate","nextProps","componentDidUpdate","componentWillUnmount","handleCancelThumbnail","render","isProcessing","progress","preprocess","postprocess","isUploaded","uploadComplete","error","uploadInProgressOrComplete","uploadStarted","uploadInProgress","isGhost","showRemoveButton","individualCancellation","showRemoveButtonAfterComplete","dashboardItemClass","recoveredState","resumableUploads","id","role","showLinkToFileUploadResult","i18n","toggleFileCard","metaFields","uppy","hideRetryButton","hideCancelButton","hidePauseResumeButton","acquirers","containerWidth","toggleAddFilesPanel","canEditFile","openFileEditor"],"mappings":"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","sourcesContent":["import {  h, Component  } from 'preact'\nimport classNames from 'classnames'\nimport shallowEqual from 'is-shallow-equal'\nimport FilePreviewAndLink from './FilePreviewAndLink/index.jsx'\nimport FileProgress from './FileProgress/index.jsx'\nimport FileInfo from './FileInfo/index.jsx'\nimport Buttons from './Buttons/index.jsx'\n\nexport default class FileItem extends Component {\n  componentDidMount () {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  shouldComponentUpdate (nextProps) {\n    return !shallowEqual(this.props, nextProps)\n  }\n\n  // VirtualList mounts FileItems again and they emit `thumbnail:request`\n  // Otherwise thumbnails are broken or missing after Golden Retriever restores files\n  componentDidUpdate () {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleRequestThumbnail(file)\n    }\n  }\n\n  componentWillUnmount () {\n    const { file } = this.props\n    if (!file.preview) {\n      this.props.handleCancelThumbnail(file)\n    }\n  }\n\n  render () {\n    const { file } = this.props\n\n    const isProcessing = file.progress.preprocess || file.progress.postprocess\n    const isUploaded = file.progress.uploadComplete && !isProcessing && !file.error\n    const uploadInProgressOrComplete = file.progress.uploadStarted || isProcessing\n    const uploadInProgress = (file.progress.uploadStarted && !file.progress.uploadComplete) || isProcessing\n    const error = file.error || false\n\n    // File that Golden Retriever was able to partly restore (only meta, not blob),\n    // users still need to re-add it, so itâ€™s a ghost\n    const { isGhost } = file\n\n    let showRemoveButton = this.props.individualCancellation\n      ? !isUploaded\n      : !uploadInProgress && !isUploaded\n\n    if (isUploaded && this.props.showRemoveButtonAfterComplete) {\n      showRemoveButton = true\n    }\n\n    const dashboardItemClass = classNames({\n      'uppy-Dashboard-Item': true,\n      'is-inprogress': uploadInProgress && !this.props.recoveredState,\n      'is-processing': isProcessing,\n      'is-complete': isUploaded,\n      'is-error': !!error,\n      'is-resumable': this.props.resumableUploads,\n      'is-noIndividualCancellation': !this.props.individualCancellation,\n      'is-ghost': isGhost,\n    })\n\n    return (\n      <div\n        className={dashboardItemClass}\n        id={`uppy_${file.id}`}\n        role={this.props.role}\n      >\n        <div className=\"uppy-Dashboard-Item-preview\">\n          <FilePreviewAndLink\n            file={file}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n            i18n={this.props.i18n}\n            toggleFileCard={this.props.toggleFileCard}\n            metaFields={this.props.metaFields}\n          />\n          <FileProgress\n            uppy={this.props.uppy}\n            file={file}\n            error={error}\n            isUploaded={isUploaded}\n            hideRetryButton={this.props.hideRetryButton}\n            hideCancelButton={this.props.hideCancelButton}\n            hidePauseResumeButton={this.props.hidePauseResumeButton}\n            recoveredState={this.props.recoveredState}\n            showRemoveButtonAfterComplete={this.props.showRemoveButtonAfterComplete}\n            resumableUploads={this.props.resumableUploads}\n            individualCancellation={this.props.individualCancellation}\n            i18n={this.props.i18n}\n          />\n        </div>\n\n        <div className=\"uppy-Dashboard-Item-fileInfoAndButtons\">\n          <FileInfo\n            file={file}\n            id={this.props.id}\n            acquirers={this.props.acquirers}\n            containerWidth={this.props.containerWidth}\n            i18n={this.props.i18n}\n            toggleAddFilesPanel={this.props.toggleAddFilesPanel}\n            toggleFileCard={this.props.toggleFileCard}\n            metaFields={this.props.metaFields}\n          />\n          <Buttons\n            file={file}\n            metaFields={this.props.metaFields}\n            showLinkToFileUploadResult={this.props.showLinkToFileUploadResult}\n            showRemoveButton={showRemoveButton}\n            canEditFile={this.props.canEditFile}\n            uploadInProgressOrComplete={uploadInProgressOrComplete}\n            toggleFileCard={this.props.toggleFileCard}\n            openFileEditor={this.props.openFileEditor}\n            uppy={this.props.uppy}\n            i18n={this.props.i18n}\n          />\n        </div>\n      </div>\n    )\n  }\n}\n"]}