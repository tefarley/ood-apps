{"version":3,"sources":["index.js"],"names":["packageJson","ReduxDevTools","UIPlugin","constructor","uppy","opts","type","id","title","defaultOptions","handleStateChange","bind","initDevTools","prevState","nextState","devTools","send","window","devToolsExtension","connect","devToolsUnsubscribe","subscribe","message","payload","reset","computedStates","nextLiftedState","store","state","getState","length","updateAll","JSON","parse","install","withDevTools","__REDUX_DEVTOOLS_EXTENSION__","on","uninstall","off","handleStateUpdate","VERSION","version"],"mappings":";;AAAA;;MAEOA,W;;;AAEP;;AACA;AACA;AACA;AACA;AACA;AACA;;AACA;;AACe,MAAMC,aAAN,SAA4BC,cAA5B,CAAqC;AAGlDC,EAAAA,WAAW,CAAEC,IAAF,EAAQC,IAAR,EAAc;AACvB,UAAMD,IAAN,EAAYC,IAAZ;AACA,SAAKC,IAAL,GAAY,UAAZ;AACA,SAAKC,EAAL,GAAU,KAAKF,IAAL,CAAUE,EAAV,IAAgB,eAA1B;AACA,SAAKC,KAAL,GAAa,gBAAb,CAJuB,CAMvB;;AACA,UAAMC,cAAc,GAAG,EAAvB,CAPuB,CASvB;;AACA,SAAKJ,IAAL,GAAY,EAAE,GAAGI,cAAL;AAAqB,SAAGJ;AAAxB,KAAZ;AAEA,SAAKK,iBAAL,GAAyB,KAAKA,iBAAL,CAAuBC,IAAvB,CAA4B,IAA5B,CAAzB;AACA,SAAKC,YAAL,GAAoB,KAAKA,YAAL,CAAkBD,IAAlB,CAAuB,IAAvB,CAApB;AACD;;AAEDD,EAAAA,iBAAiB,CAAEG,SAAF,EAAaC,SAAb,EAAwB;AACvC,SAAKC,QAAL,CAAcC,IAAd,CAAmB,mBAAnB,EAAwCF,SAAxC;AACD;;AAEDF,EAAAA,YAAY,GAAI;AACd,SAAKG,QAAL,GAAgBE,MAAM,CAACC,iBAAP,CAAyBC,OAAzB,EAAhB;AACA,SAAKC,mBAAL,GAA2B,KAAKL,QAAL,CAAcM,SAAd,CAAyBC,OAAD,IAAa;AAC9D,UAAIA,OAAO,CAAChB,IAAR,KAAiB,UAArB,EAAiC;AAC/B;AACA,gBAAQgB,OAAO,CAACC,OAAR,CAAgBjB,IAAxB;AACE,eAAK,OAAL;AACE,iBAAKF,IAAL,CAAUoB,KAAV;AACA;;AACF,eAAK,cAAL;AAAqB;AACnB,oBAAM;AAAEC,gBAAAA;AAAF,kBAAqBH,OAAO,CAACC,OAAR,CAAgBG,eAA3C;AACA,mBAAKtB,IAAL,CAAUuB,KAAV,CAAgBC,KAAhB,GAAwB,EAAE,GAAG,KAAKxB,IAAL,CAAUyB,QAAV,EAAL;AAA2B,mBAAGJ,cAAc,CAACA,cAAc,CAACK,MAAf,GAAwB,CAAzB,CAAd,CAA0CF;AAAxE,eAAxB;AACA,mBAAKxB,IAAL,CAAU2B,SAAV,CAAoB,KAAK3B,IAAL,CAAUyB,QAAV,EAApB;AACA;AACD;;AACD,eAAK,eAAL;AACA,eAAK,gBAAL;AACE,iBAAKzB,IAAL,CAAUuB,KAAV,CAAgBC,KAAhB,GAAwB,EAAE,GAAG,KAAKxB,IAAL,CAAUyB,QAAV,EAAL;AAA2B,iBAAGG,IAAI,CAACC,KAAL,CAAWX,OAAO,CAACM,KAAnB;AAA9B,aAAxB;AACA,iBAAKxB,IAAL,CAAU2B,SAAV,CAAoB,KAAK3B,IAAL,CAAUyB,QAAV,EAApB;AACA;;AAEF;AAhBF;AAkBD;AACF,KAtB0B,CAA3B;AAuBD;;AAEDK,EAAAA,OAAO,GAAI;AACT;AACA,SAAKC,YAAL,GAAoB,OAAOlB,MAAP,KAAkB,WAAlB,IAAiCA,MAAM,CAACmB,4BAA5D;;AACA,QAAI,KAAKD,YAAT,EAAuB;AACrB,WAAKvB,YAAL;AACA,WAAKR,IAAL,CAAUiC,EAAV,CAAa,cAAb,EAA6B,KAAK3B,iBAAlC;AACD;AACF;;AAED4B,EAAAA,SAAS,GAAI;AACX,QAAI,KAAKH,YAAT,EAAuB;AACrB,WAAKf,mBAAL;AACA,WAAKhB,IAAL,CAAUmC,GAAV,CAAc,cAAd,EAA8B,KAAKC,iBAAnC;AACD;AACF;;AAhEiD;;AAA/BvC,a,CACZwC,O,GAAUzC,WAAW,CAAC0C,O;iBADVzC,a","sourcesContent":["import { UIPlugin } from '@uppy/core'\n\nimport packageJson from '../package.json'\n\n/* eslint-disable max-len */\n/**\n * Add Redux DevTools support to Uppy\n *\n * See https://medium.com/@zalmoxis/redux-devtools-without-redux-or-how-to-have-a-predictable-state-with-any-architecture-61c5f5a7716f\n * and https://github.com/zalmoxisus/mobx-remotedev/blob/master/src/monitorActions.js\n */\n/* eslint-enable max-len */\nexport default class ReduxDevTools extends UIPlugin {\n  static VERSION = packageJson.version\n\n  constructor (uppy, opts) {\n    super(uppy, opts)\n    this.type = 'debugger'\n    this.id = this.opts.id || 'ReduxDevTools'\n    this.title = 'Redux DevTools'\n\n    // set default options\n    const defaultOptions = {}\n\n    // merge default options with the ones set by user\n    this.opts = { ...defaultOptions, ...opts }\n\n    this.handleStateChange = this.handleStateChange.bind(this)\n    this.initDevTools = this.initDevTools.bind(this)\n  }\n\n  handleStateChange (prevState, nextState) {\n    this.devTools.send('UPPY_STATE_UPDATE', nextState)\n  }\n\n  initDevTools () {\n    this.devTools = window.devToolsExtension.connect()\n    this.devToolsUnsubscribe = this.devTools.subscribe((message) => {\n      if (message.type === 'DISPATCH') {\n        // Implement monitors actions\n        switch (message.payload.type) {\n          case 'RESET':\n            this.uppy.reset()\n            return\n          case 'IMPORT_STATE': {\n            const { computedStates } = message.payload.nextLiftedState\n            this.uppy.store.state = { ...this.uppy.getState(), ...computedStates[computedStates.length - 1].state }\n            this.uppy.updateAll(this.uppy.getState())\n            return\n          }\n          case 'JUMP_TO_STATE':\n          case 'JUMP_TO_ACTION':\n            this.uppy.store.state = { ...this.uppy.getState(), ...JSON.parse(message.state) }\n            this.uppy.updateAll(this.uppy.getState())\n            break\n\n          default:\n        }\n      }\n    })\n  }\n\n  install () {\n    // eslint-disable-next-line no-underscore-dangle\n    this.withDevTools = typeof window !== 'undefined' && window.__REDUX_DEVTOOLS_EXTENSION__\n    if (this.withDevTools) {\n      this.initDevTools()\n      this.uppy.on('state-update', this.handleStateChange)\n    }\n  }\n\n  uninstall () {\n    if (this.withDevTools) {\n      this.devToolsUnsubscribe()\n      this.uppy.off('state-update', this.handleStateUpdate)\n    }\n  }\n}\n"]}